import{j as A,r as c,o as M,a2 as G,Q as $,R as m,L as i,J as n,M as e,K as y,W as K,F as O,P as L,a3 as q,I as J,X as P,S as _,U as Q,O as d}from"./vue-DM6FGnPB.js";import{_ as W}from"./Navigation-Return-CUJ0SQdH.js";import{d as X,g as E,j as H,i as Y,k as T,l as Z,f as j,c as ee,E as te,_ as ae}from"./index-D6Hz3-vS.js";import{T as C,A as oe,s as se}from"./actionSheet-BtHMRMoS.js";import{M as re,p as ie}from"./postComment-ZHowVVZ4.js";import"./domPurify-BPcjySmD.js";import"./markdown-DCtE0EIs.js";import"./heilight-WM7bhzTF.js";import"./katex-C_PMC0W0.js";import"./system.config-Nd7wdUBW.js";import"./getUserCurentAvatarByID-C_abxhlB.js";import"./infiniteScroll-CP5iaxsj.js";const ne={style:{"text-align":"left","z-index":"10",position:"relative"}},le={key:0,class:"coverProject coverBottom"},ce={style:{margin:"0","font-size":"smaller"}},ue={style:{margin:"0","font-size":"medium"}},pe={style:{"text-align":"center",height:"100%"}},me={id:"project-list",class:"projects"},de={class:"right-bottom-container"},ge={class:"message-wrapper"},fe={class:"sendComment"},ve=A({__name:"Profile",setup(ye){const{t:l}=X();let u=c(""),k=c(!1),D=c(1),U=c("");const w=c("Intro"),o=G();let x=c(""),t=c({User:{ID:"",Nickname:"Loading...",Signature:"",Verification:"loading...",Avatar:322,AvatarRegion:0,Decoration:0,Gold:17900,Diamond:2683,Fragment:116,Level:25,Experience:62225,Prestige:18,Subscription:1,SubscriptionUntil:"",IsBinded:!0,Regions:[1]},Statistic:{Cover:{ID:"",Category:"",Subject:"",Image:1},CommentCount:0,ExperimentCount:0,FollowerCount:0,FollowingCount:0}}),b=c({});M(async()=>{const a=await E("/Contents/GetProfile",{ID:o.params.id});b.value=a.Data.Experiments;const s=await E("/Users/GetUser",{ID:o.params.id});t.value=s.Data;const g=t.value.Statistic.Cover?H(t.value.Statistic.Cover):Y(s.Data.User);await fetch(g,{referrerPolicy:"no-referrer",mode:"no-cors"}),x.value=g,window.$Logger.logPageView({pageLink:"/User/".concat(o.params.id,"/"),timeStamp:Date.now()})});function F(a){U.value=a.userID,u.value="回复@".concat(a.msg_title,": ")}async function N(){await ie(u,k,"User",o.params.id,U,D)}function B(){window.history.back()}function R(a){switch(a){case"Latest-Experiments":return"experiments://UserID/".concat(o.params.id);case"Featured-Experiments":return"experiments://UserID/".concat(o.params.id,"/Tags/精选");case"Latest-Discussions":return"discussions://UserID/".concat(o.params.id);case"Featured-Discussions":return"discussions://UserID/".concat(o.params.id,"/Tags/精选");case"Popular-Discussions":return"discussions://UserID/".concat(o.params.id,"/Sort/2");case"Popular-Experiments":return"experiments://UserID/".concat(o.params.id,"/Sort/2");default:return"discussions://user".concat(o.params.id)}}function f(a){navigator.clipboard.writeText(a).then(()=>{j.emit("info","copied",1)}).catch(s=>{j.emit("error","failed to copy text",2,s)})}function z(){se([{label:l("profile.copyID")},{label:l("profile.copyInternalLink")},{label:l("profile.copyExternalLink")}],a=>{a===0?f(t.value.User.ID):a===1?f("<user=".concat(t.value.User.ID,">").concat(t.value.User.Nickname,"</user>")):a===2&&f("<external=".concat(window.location.href,">").concat(t.value.User.Nickname,"[web]</external>"))})}return(a,s)=>{const g=L("router-link"),V=L("n-input");return d(),$(oe,null,{left:m(()=>{var r,p,h,I,S;return[i("div",{class:"cover",style:Q({backgroundImage:"url(".concat(e(x),")"),backgroundRepeat:"no-repeat",backgroundSize:"cover",backgroundPosition:"center"})},[i("div",ne,[i("img",{src:W,style:{width:"2.7em"},class:"return",onClick:B}),i("div",{style:{color:"white","font-size":"2em","text-align":"left"},onClick:s[0]||(s[0]=v=>z())},_(e(t).User.Nickname),1),n(C,{category:"User",tag:(r=e(t).User)!=null&&r.Verification?"C-"+((p=e(t).User)==null?void 0:p.Verification):"C-user",style:{color:"aquamarine","font-weight":"bold"}},null,8,["tag"]),n(C,{category:"User",tag:e(l)("profile.fans",{count:e(t).Statistic.FollowerCount})},null,8,["tag"]),n(C,{category:"User",tag:e(l)("profile.follows",{count:e(t).Statistic.FollowingCount})},null,8,["tag"])]),(h=e(t).Statistic)!=null&&h.Cover?(d(),y("div",le,[n(g,{to:"/experimentSummary/"+((I=e(t).Statistic.Cover)==null?void 0:I.Category)+"/"+((S=e(t).Statistic.Cover)==null?void 0:S.ID),style:{color:"white","text-align":"left","text-decoration":"none","z-index":"30",position:"relative"}},{default:m(()=>{var v;return[i("p",ce,_(e(l)("profile.coverTip")),1),i("p",ue,_((v=e(t).Statistic.Cover)==null?void 0:v.Subject),1)]}),_:1},8,["to"])])):P("",!0)],4)]}),right:m(()=>[i("div",pe,[n(e(Z),{value:w.value,"onUpdate:value":s[2]||(s[2]=r=>w.value=r),"justify-content":"space-evenly",type:"line"},{default:m(()=>[n(e(T),{name:"Intro",tab:e(l)("profile.works"),animated:""},{default:m(()=>[i("div",me,[(d(!0),y(O,null,K(Object.entries(e(b)),([r,p])=>(d(),y("div",{key:r},[p.length>0?(d(),$(ee,{key:0,title:r,data:p,"block-type":p[0].Category,link:e(te)(R(r))},null,8,["title","data","block-type","link"])):P("",!0)]))),128))])]),_:1},8,["tab"]),n(e(T),{name:"Comment",tab:e(l)("profile.comments",{count:e(t).Statistic.CommentCount})},{default:m(()=>[i("div",de,[i("div",ge,[n(re,{ID:e(o).params.id,Category:"User",upDate:e(D),onMsgClick:F},null,8,["ID","upDate"])]),i("div",fe,[n(V,{value:e(u),"onUpdate:value":s[1]||(s[1]=r=>J(u)?u.value=r:u=r),style:{"text-align":"left"},type:"text",placeholder:"发布一条友善的言论","show-count":"",maxlength:300,loading:e(k),onKeyup:q(N,["enter"])},null,8,["value","loading"])])])]),_:1},8,["tab"])]),_:1},8,["value"])])]),_:1})}}}),Le=ae(ve,[["__scopeId","data-v-69889b1b"]]);export{Le as default};
