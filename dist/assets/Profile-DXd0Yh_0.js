import{d as R,r as c,a as z,g as v,b as d,c as f,f as o,y as h,u as e,e as n,w as m,z as N,x as T,q as S,C as w,F as $,i as E,j as F,k as P,h as j,t as L,v as V,D as G,E as q,_ as A}from"./index-B-eZ0YOv.js";import{_ as K}from"./Navigation-Return-DzxIbTju.js";import{T as _}from"./TagLarger-XFzWJdH3.js";import{M as O}from"./MessageList-CCQ-pEwV.js";import"./usercard-CJfEyHAw.js";const W={class:"container"},H={style:{"text-align":"left","z-index":"10",position:"relative"}},J={style:{color:"white","font-size":"2em","text-align":"left"}},Q={style:{"margin-top":"auto",color:"white",height:"40px","background-color":"rgba(128, 128, 128, 0.4)","border-radius":"10px",padding:"8px"}},X={style:{margin:"0","font-size":"medium"}},Y={style:{"text-align":"center"},class:"context"},Z={style:{display:"flex","flex-direction":"column",gap:"5px"},class:"message-list"},ee={class:"message-list"},te={class:"sendComment"},ae=R({__name:"Profile",setup(oe){let i=c(""),p=c(!1),y=c(1),C="";const x=c("Intro"),u=T();let k=c(""),t=c({User:{ID:"",Nickname:"Loading...",Signature:"",Verification:"loading...",Avatar:322,AvatarRegion:0,Decoration:0,Gold:17900,Diamond:2683,Fragment:116,Level:25,Experience:62225,Prestige:18,Subscription:1,SubscriptionUntil:"",IsBinded:!0,Regions:[1]},Statistic:{Cover:{ID:"",Category:"",Subject:"",Image:1},CommentCount:0,ExperimentCount:0,FollowerCount:0,FollowingCount:0}}),D=c({});z(async()=>{const s=await v("/Contents/GetProfile",{ID:u.params.id});D.value=s.Data.Experiments,console.log(s);const a=await v("/Users/GetUser",{ID:u.params.id});console.log(a),t.value=a.Data;const l=t.value.Statistic.Cover.ID;k.value=`http://physics-static-cn.turtlesim.com:80/experiments/images/${l.slice(0,4)}/${l.slice(4,6)}/${l.slice(6,8)}/${l.slice(8,24)}/${t.value.Statistic.Cover.Image}.jpg!full`});function I(s){C=s.userID,i.value=`回复@${s.msg_title}: `}const U=async()=>{p.value=!0;const s=await v("/Messages/PostComment",{TargetID:u.params.id,TargetType:"User",Content:i.value||"",ReplyID:C||"",Language:"from web",Special:null});if(s.Status==200)i.value="",y.value=Math.random();else if(s.Status==403&&s.Message.startsWith("Stopword.Blocked")){const a=Number("Stopword.Blocked.Details|0".slice("Stopword.Blocked.Details|0".indexOf("|")+1)),l=i.value.slice(a,10);q.emit("error",`您输入的内容“...${l}...”中包含不适合词句`,1)}p.value=!1},B=()=>{window.history.back()};return(s,a)=>{var b;const l=S("router-link"),M=S("n-input");return d(),f("div",W,[o("div",{class:"cover",style:N({backgroundImage:`url(${e(k)})`,backgroundRepeat:"no-repeat",backgroundSize:"cover",backgroundPosition:"center"})},[o("div",H,[o("img",{src:K,style:{width:"2.7em"},onClick:B}),o("div",J,h(e(t).User.Nickname),1),n(_,{tag:((b=e(t).User)==null?void 0:b.Verification)||"user",style:{color:"aquamarine","font-weight":"bold"}},null,8,["tag"]),n(_,{tag:"粉丝 "+e(t).Statistic.FollowerCount},null,8,["tag"]),n(_,{tag:"关注 "+e(t).Statistic.FollowingCount},null,8,["tag"])]),o("div",Q,[n(l,{to:"/experimentSummary/"+e(t).Statistic.Cover.Category+"/"+e(t).Statistic.Cover.ID,style:{color:"white","text-align":"left","text-decoration":"none","z-index":"30",position:"relative"}},{default:m(()=>[a[2]||(a[2]=o("p",{style:{margin:"0","font-size":"smaller"}},"点击进入封面作品",-1)),o("p",X,h(e(t).Statistic.Cover.Subject),1)]),_:1},8,["to"])])],4),o("div",Y,[n(e(G),{value:x.value,"onUpdate:value":a[1]||(a[1]=r=>x.value=r),"justify-content":"space-evenly",type:"line"},{default:m(()=>[n(e(w),{name:"Intro",tab:"作品"},{default:m(()=>[o("div",Z,[(d(!0),f($,null,E(Object.entries(e(D)),([r,g])=>(d(),f("div",{key:r},[g.length>0?(d(),F(P,{key:0,title:r,data:g,"block-type":g[0].Category},null,8,["title","data","block-type"])):j("",!0)]))),128))])]),_:1}),n(e(w),{name:"Comment",tab:`留言板(${e(t).Statistic.CommentCount})`},{default:m(()=>[o("div",ee,[n(O,{ID:e(u).params.id,Category:"User",upDate:e(y),onMsgClick:I},null,8,["ID","upDate"]),o("div",te,[n(M,{value:e(i),"onUpdate:value":a[0]||(a[0]=r=>L(i)?i.value=r:i=r),style:{"text-align":"left"},type:"text",placeholder:"发布一条友善的言论","show-count":"",maxlength:200,onKeyup:V(U,["enter"]),loading:e(p)},null,8,["value","loading"])])])]),_:1},8,["tab"])]),_:1},8,["value"])])])}}}),ce=A(ae,[["__scopeId","data-v-04929e52"]]);export{ce as default};
